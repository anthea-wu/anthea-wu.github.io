<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="ç”¨è‡ªå‹•è²©è³£æ©Ÿç¯„ä¾‹å­¸æœƒ useImperativeHandle"><title>React åˆå¿ƒè€…å¤§è£œå¸–ï¼ˆ3ï¼‰</title><link rel=canonical href=https://anthea-wu.github.io/post/react-june-3/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="React åˆå¿ƒè€…å¤§è£œå¸–ï¼ˆ3ï¼‰"><meta property='og:description' content="ç”¨è‡ªå‹•è²©è³£æ©Ÿç¯„ä¾‹å­¸æœƒ useImperativeHandle"><meta property='og:url' content='https://anthea-wu.github.io/post/react-june-3/'><meta property='og:site_name' content="Anthea's Blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='React'><meta property='article:tag' content='JavaScript'><meta property='article:published_time' content='2025-06-06T15:30:00+08:00'><meta property='article:modified_time' content='2025-06-06T15:30:00+08:00'><meta name=twitter:title content="React åˆå¿ƒè€…å¤§è£œå¸–ï¼ˆ3ï¼‰"><meta name=twitter:description content="ç”¨è‡ªå‹•è²©è³£æ©Ÿç¯„ä¾‹å­¸æœƒ useImperativeHandle"><script async src="https://www.googletagmanager.com/gtag/js?id=G-WDCDS5VPR1"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-WDCDS5VPR1")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_d8c2fe4d260f28d7.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Anthea's Blog</a></h1><h2 class=site-description>Engineer</h2></div></header><ol class=menu-social><li><a href=https://github.com/anthea-wu target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/page/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/page/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/page/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/books target=_blank><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-book"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 19a9 9 0 019 0 9 9 0 019 0"/><path d="M3 6a9 9 0 019 0 9 9 0 019 0"/><path d="M3 6v13"/><path d="M12 6v13"/><path d="M21 6v13"/></svg>
<span>Books</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ul><li><a href=#-ä»€éº¼æ˜¯-useimperativehandle>ğŸ’¡ ä»€éº¼æ˜¯ <code>useImperativeHandle</code></a></li><li><a href=#-ç¯„ä¾‹ä»‹ç´¹ä¸€å°è‡ªå‹•è²©è³£æ©Ÿ>ğŸ§ª ç¯„ä¾‹ä»‹ç´¹ï¼šä¸€å°è‡ªå‹•è²©è³£æ©Ÿ</a></li><li><a href=#-å»ºç«‹å¯æ§åˆ¶çš„å­å…ƒä»¶vendingmachine>ğŸ‘· å»ºç«‹å¯æ§åˆ¶çš„å­å…ƒä»¶ï¼šVendingMachine</a><ul><li><a href=#ç¬¬ä¸€æ­¥ä½¿ç”¨-forwardref-åŒ…è£å…ƒä»¶>ç¬¬ä¸€æ­¥ï¼šä½¿ç”¨ <code>forwardRef</code> åŒ…è£å…ƒä»¶</a></li><li><a href=#ç¬¬äºŒæ­¥å®šç¾©è¦æš´éœ²çµ¦å¤–éƒ¨çš„åŠŸèƒ½>ç¬¬äºŒæ­¥ï¼šå®šç¾©è¦æš´éœ²çµ¦å¤–éƒ¨çš„åŠŸèƒ½</a></li></ul></li><li><a href=#-çˆ¶å…ƒä»¶é€é-ref-å‘¼å«å­å…ƒä»¶æ–¹æ³•>ğŸ‘¨â€ğŸ”§ çˆ¶å…ƒä»¶ï¼šé€é ref å‘¼å«å­å…ƒä»¶æ–¹æ³•</a><ul><li><a href=#ç¬¬ä¸‰æ­¥ä½¿ç”¨-useref-å»ºç«‹-ref>ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨ <code>useRef</code> å»ºç«‹ ref</a></li><li><a href=#ç¬¬å››æ­¥åœ¨çˆ¶å…ƒä»¶ä¸­å‘¼å«å­å…ƒä»¶æ–¹æ³•>ç¬¬å››æ­¥ï¼šåœ¨çˆ¶å…ƒä»¶ä¸­å‘¼å«å­å…ƒä»¶æ–¹æ³•</a></li></ul></li><li><a href=#-useimperativehandle-çš„æ‡‰ç”¨æƒ…å¢ƒ>âœ… <code>useImperativeHandle</code> çš„æ‡‰ç”¨æƒ…å¢ƒ</a></li><li><a href=#-çµèª>ğŸ“ çµèª</a></li></ul></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/technical/>Technical</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/react-june-3/>React åˆå¿ƒè€…å¤§è£œå¸–ï¼ˆ3ï¼‰</a></h2><h3 class=article-subtitle>ç”¨è‡ªå‹•è²©è³£æ©Ÿç¯„ä¾‹å­¸æœƒ useImperativeHandle</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2025/06/06</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>1 minute read</time></div></footer></div></header><section class=article-content><p>åœ¨ React è£¡ï¼Œçˆ¶å…ƒä»¶é€šå¸¸ ç„¡æ³•ç›´æ¥æ§åˆ¶å­å…ƒä»¶çš„å…§éƒ¨ç‹€æ…‹æˆ–è¡Œç‚ºã€‚ä½†æœ‰æ™‚å€™ï¼Œæˆ‘å€‘å¸Œæœ› çˆ¶å…ƒä»¶å¯ä»¥é€éæŸäº›æ–¹æ³•æ“ä½œå­å…ƒä»¶ï¼Œä¾‹å¦‚ï¼šé‡ç½®ç‹€æ…‹ã€è®€å–è³‡æ–™æˆ–è§¸ç™¼æŸäº›äº‹ä»¶â€”â€”é€™æ™‚å€™ï¼Œ<code>useImperativeHandle</code> å°±èƒ½æ´¾ä¸Šç”¨å ´ã€‚</p><p>é€™ç¯‡æ–‡ç« å°‡é€éä¸€å€‹ã€Œè‡ªå‹•è²©è³£æ©Ÿã€çš„ç¯„ä¾‹ï¼Œä¸€æ­¥æ­¥äº†è§£ï¼š</p><ul><li>ä»€éº¼æ˜¯ <code>useImperativeHandle</code></li><li>å®ƒç‚ºä»€éº¼éœ€è¦æ­é… forwardRef</li><li>å¦‚ä½•åœ¨å¯¦å‹™ä¸­é‹ç”¨å®ƒä¾†å»ºç«‹ä¸€å€‹ã€Œå¯ç”±çˆ¶å…ƒä»¶é™æ§çš„å­å…ƒä»¶ã€</li></ul><h2 id=-ä»€éº¼æ˜¯-useimperativehandle>ğŸ’¡ ä»€éº¼æ˜¯ <code>useImperativeHandle</code></h2><p><code>useImperativeHandle</code> æ˜¯ä¸€å€‹ React Hookï¼Œè®“ä½ å¯ä»¥ è‡ªè¨‚ä¸€å€‹ ref å°æ‡‰çš„ç‰©ä»¶å…§å®¹ã€‚é€™æ¨£çˆ¶å…ƒä»¶åœ¨é€é ref å–å¾—å­å…ƒä»¶æ™‚ï¼Œä¸æœƒæ‹¿åˆ°æ•´å€‹ DOM æˆ–å…ƒä»¶å¯¦ä¾‹ï¼Œè€Œæ˜¯å–å¾—ä½ ã€Œæƒ³è¦æš´éœ²å‡ºå»çš„åŠŸèƒ½ã€ã€‚</p><p>å®ƒé€šå¸¸è¦å’Œ <code>forwardRef</code> ä¸€èµ·ä½¿ç”¨ï¼Œæ‰èƒ½è®“å‡½å¼å‹å…ƒä»¶æ”¯æ´ refã€‚</p><h2 id=-ç¯„ä¾‹ä»‹ç´¹ä¸€å°è‡ªå‹•è²©è³£æ©Ÿ>ğŸ§ª ç¯„ä¾‹ä»‹ç´¹ï¼šä¸€å°è‡ªå‹•è²©è³£æ©Ÿ</h2><p>å‡è¨­æˆ‘å€‘æœ‰ä¸€å€‹ VendingMachine å…ƒä»¶ï¼Œä»–æœ‰è‡ªå·±çš„å…§éƒ¨ç‹€æ…‹ï¼ŒåŒ…å«å·²é¸æ“‡çš„å•†å“ã€æŠ•å…¥çš„é‡‘é¡ç­‰ç­‰ã€‚ä½†é€šå¸¸ä¾†èªªï¼Œæˆ‘å€‘é‚„æœƒéœ€è¦ä¸€äº›å…¶ä»–çš„åŠŸèƒ½ï¼Œä¾‹å¦‚å®¢äººç™¼ç¾ä»–é¸éŒ¯é£²æ–™äº†ï¼Œæƒ³è¦å–æ¶ˆè³¼è²·ï¼›æˆ–æ˜¯è²©è³£æ©Ÿç•°å¸¸äº†ï¼Œå·¥ç¨‹å¸«ä¾†ç¶­ä¿®çš„æ™‚å€™æƒ³è¦é‡ç½®æ•´å€‹é£²æ–™æ©Ÿçš„ç‹€æ…‹ï¼Œé€™å…©å€‹è¡Œç‚ºéƒ½æœƒç‰½æ¶‰åˆ° VendingMachine çš„å…§éƒ¨ç‹€æ…‹ï¼Œä½†å› ç‚º é€™äº›æ“ä½œæ˜¯åœ¨çˆ¶å…ƒä»¶ä¸­è§¸ç™¼çš„è¡Œç‚ºï¼Œå­å…ƒä»¶è‡ªå·±ç„¡æ³•é æ¸¬ï¼Œä¹Ÿä¸æ‡‰è©²è‡ªè¡Œè™•ç†ã€‚</p><p>é€™æ¨£åšæœ‰å¹¾å€‹å¥½è™•ï¼š</p><ul><li><strong>ä¿æŒå°è£æ€§</strong>ï¼šå­å…ƒä»¶ä»ç„¶æ§åˆ¶è‡ªå·±çš„ stateï¼Œå¤–éƒ¨åªèƒ½é€éã€ŒæŒ‡å®šçš„ä»‹é¢ã€ä¾†æ“ä½œå®ƒã€‚</li><li><strong>æä¾›æ˜ç¢º API</strong>ï¼šè®“å…ƒä»¶çš„ä½¿ç”¨è€…çŸ¥é“æœ‰å“ªäº›åŠŸèƒ½å¯ä»¥ç”¨ï¼Œä¸æœƒäº‚æ“ä½œã€‚</li><li><strong>æ‡‰ä»˜è¤‡é›œäº¤äº’é‚è¼¯</strong>ï¼šåƒæ˜¯ã€Œå–æ¶ˆäº¤æ˜“ã€ã€ã€Œé‡ç½®ç³»çµ±ã€é€™é¡è·¨å…ƒä»¶æ“ä½œå°±èƒ½è¢«å¦¥å–„è™•ç†ã€‚</li></ul><p>å› æ­¤ï¼Œåœ¨æˆ‘å€‘çš„è‡ªå‹•è²©è³£æ©Ÿç¯„ä¾‹ä¸­ï¼Œæˆ‘å€‘é¸æ“‡å°‡ä»¥ä¸‹ä¸‰å€‹åŠŸèƒ½é€é <code>useImperativeHandle</code> æä¾›çµ¦å¤–éƒ¨å…ƒä»¶ä½¿ç”¨ï¼š</p><ul><li><code>cancelSelection</code>: å®¢äººå–æ¶ˆäº¤æ˜“</li><li><code>resetMachine</code>: å·¥ç¨‹å¸«é‡ç½®æ©Ÿå™¨</li><li><code>getCurrentStatus</code>: æŸ¥è©¢ç›®å‰è²©è³£æ©Ÿçš„ç‹€æ…‹</li></ul><p>ä¸‹ä¸€æ­¥å°±è®“æˆ‘å€‘ä¾†çœ‹è¦æ€éº¼ä½¿ç”¨ <code>useImperativeHandle</code> å§ã€‚</p><h2 id=-å»ºç«‹å¯æ§åˆ¶çš„å­å…ƒä»¶vendingmachine>ğŸ‘· å»ºç«‹å¯æ§åˆ¶çš„å­å…ƒä»¶ï¼šVendingMachine</h2><h3 id=ç¬¬ä¸€æ­¥ä½¿ç”¨-forwardref-åŒ…è£å…ƒä»¶>ç¬¬ä¸€æ­¥ï¼šä½¿ç”¨ <code>forwardRef</code> åŒ…è£å…ƒä»¶</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>VendingMachine</span> <span class=o>=</span> <span class=nx>forwardRef</span><span class=o>&lt;</span><span class=nx>VendingMachineRef</span><span class=p>,</span> <span class=nx>VendingMachineProps</span><span class=o>&gt;</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// component
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ç¬¬äºŒæ­¥å®šç¾©è¦æš´éœ²çµ¦å¤–éƒ¨çš„åŠŸèƒ½>ç¬¬äºŒæ­¥ï¼šå®šç¾©è¦æš´éœ²çµ¦å¤–éƒ¨çš„åŠŸèƒ½</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>useImperativeHandle</span><span class=p>(</span><span class=nx>ref</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>cancelSelection</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// æ¸…é™¤ç‹€æ…‹ä¸¦é€šçŸ¥å–æ¶ˆ
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>resetMachine</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// å°‡ç‹€æ…‹é‡ç½®ç‚ºåˆå§‹ç‹€æ…‹
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>getCurrentStatus</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// å›å‚³ç›®å‰çš„ç‹€æ…‹æè¿°å­—ä¸²
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}),</span> <span class=p>[</span><span class=nx>selectedItem</span><span class=p>,</span> <span class=nx>insertedMoney</span><span class=p>,</span> <span class=nx>status</span><span class=p>,</span> <span class=nx>onCancel</span><span class=p>]);</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=-çˆ¶å…ƒä»¶é€é-ref-å‘¼å«å­å…ƒä»¶æ–¹æ³•>ğŸ‘¨â€ğŸ”§ çˆ¶å…ƒä»¶ï¼šé€é ref å‘¼å«å­å…ƒä»¶æ–¹æ³•</h2><h3 id=ç¬¬ä¸‰æ­¥ä½¿ç”¨-useref-å»ºç«‹-ref>ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨ <code>useRef</code> å»ºç«‹ ref</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>vendingMachineRef</span> <span class=o>=</span> <span class=nx>useRef</span><span class=o>&lt;</span><span class=nx>VendingMachineRef</span><span class=o>&gt;</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ç¬¬å››æ­¥åœ¨çˆ¶å…ƒä»¶ä¸­å‘¼å«å­å…ƒä»¶æ–¹æ³•>ç¬¬å››æ­¥ï¼šåœ¨çˆ¶å…ƒä»¶ä¸­å‘¼å«å­å…ƒä»¶æ–¹æ³•</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>customerCancel</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>vendingMachineRef</span><span class=p>.</span><span class=nx>current</span><span class=o>?</span><span class=p>.</span><span class=nx>cancelSelection</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>technicianReset</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>vendingMachineRef</span><span class=p>.</span><span class=nx>current</span><span class=o>?</span><span class=p>.</span><span class=nx>resetMachine</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>checkStatus</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>status</span> <span class=o>=</span> <span class=nx>vendingMachineRef</span><span class=p>.</span><span class=nx>current</span><span class=o>?</span><span class=p>.</span><span class=nx>getCurrentStatus</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=nx>setMachineStatus</span><span class=p>(</span><span class=nx>status</span> <span class=o>??</span> <span class=s2>&#34;ç„¡æ³•ç²å–ç‹€æ…‹&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=-useimperativehandle-çš„æ‡‰ç”¨æƒ…å¢ƒ>âœ… <code>useImperativeHandle</code> çš„æ‡‰ç”¨æƒ…å¢ƒ</h2><p>é€™ç¨®åšæ³•ç‰¹åˆ¥é©åˆç”¨åœ¨ï¼š</p><ul><li><strong>è¡¨å–®æ§åˆ¶</strong>ï¼šä¾‹å¦‚è®“çˆ¶å…ƒä»¶è§¸ç™¼è¡¨å–®é©—è­‰ã€é‡ç½®æ¬„ä½</li><li><strong>å¤–éƒ¨æ§åˆ¶å…ƒä»¶</strong>ï¼šåƒ modalã€canvasã€åœ–è¡¨ã€éŸ³æ¨‚æ’­æ”¾å™¨ç­‰éœ€è¦æ§åˆ¶çš„ UI</li><li><strong>è¨­è¨ˆå¯è¤‡ç”¨å…ƒä»¶ API</strong>ï¼šæŠŠå…§éƒ¨é‚è¼¯åŒ…åœ¨å…ƒä»¶ä¸­ï¼Œåªæš´éœ²å¿…è¦çš„ API çµ¦ä½¿ç”¨è€…</li></ul><p>ä¸éè¦æ³¨æ„çš„æ˜¯ï¼Œ<code>useImperativeHandle</code> ä¸æœƒè®“ä½ ç¹é React çš„ã€Œå–®å‘è³‡æ–™æµã€åŸå‰‡ï¼Œå› ç‚ºä½ åªèƒ½æ“ä½œå­å…ƒä»¶ã€Œå…è¨±ã€çš„éƒ¨åˆ†ã€‚</p><p>è‹¥çˆ¶å…ƒä»¶å¯ä»¥ç›´æ¥æ§åˆ¶å…¨éƒ¨ç‹€æ…‹ï¼Œé‚£å°±ä¸éœ€è¦é€™å€‹ hookï¼Œåªæœ‰åœ¨å­å…ƒä»¶å…§éƒ¨é‚è¼¯è¤‡é›œã€ä½†åˆéœ€è¦æä¾›éƒ¨åˆ†æ§åˆ¶çµ¦å¤–éƒ¨æ™‚æ‰ç”¨å¾—åˆ°ã€‚</p><h2 id=-çµèª>ğŸ“ çµèª</h2><p><code>useImperativeHandle</code> åœ¨å¯¦å‹™ä¸­é›–ç„¶ä½¿ç”¨é »ç‡ä¸é«˜ï¼Œä½†åœ¨è™•ç†ä¸€äº›é€²éšçš„äº’å‹•å ´æ™¯ï¼ˆä¾‹å¦‚é€™å€‹è‡ªå‹•è²©è³£æ©Ÿï¼‰æ™‚ï¼Œå¯ä»¥å¹«ä½ å»ºç«‹ä¹¾æ·¨åˆå¯æ§åˆ¶çš„å…ƒä»¶ APIï¼Œè®“å…ƒä»¶è¨­è¨ˆæ›´å½ˆæ€§ã€æ›´æ¨¡çµ„åŒ–ã€‚</p><p>å¸Œæœ›ä½ å–œæ­¡ä»Šå¤©çš„æ–‡ç« ï¼Œæˆ‘å€‘ä¸‹æ¬¡å†è¦‹ ğŸ‘‹ğŸ»</p></section><footer class=article-footer><section class=article-tags><a href=/tags/react/>React</a>
<a href=/tags/javascript/>JavaScript</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/post/react-juniors-2/><div class=article-details><h2 class=article-title>React åˆå¿ƒè€…å¤§è£œå¸–ï¼ˆ2ï¼‰</h2></div></a></article><article><a href=/post/react-junior-1/><div class=article-details><h2 class=article-title>React åˆå¿ƒè€…å¤§è£œå¸–ï¼ˆ1ï¼‰</h2></div></a></article><article><a href=/post/javascript-%E5%B7%A5%E7%A8%8B%E5%B8%AB%E7%9A%84%E4%BF%AE%E8%A1%8C%E4%B9%8B%E8%B7%AF1/><div class=article-details><h2 class=article-title>JavaScript å·¥ç¨‹å¸«çš„ä¿®è¡Œä¹‹è·¯ï¼ˆ1ï¼‰</h2></div></a></article><article><a href=/post/javascript-journey-2/><div class=article-details><h2 class=article-title>JavaScript å·¥ç¨‹å¸«çš„ä¿®è¡Œä¹‹è·¯ï¼ˆ2ï¼‰</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2022 -
2025 Anthea's Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>